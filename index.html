<html>
<head>
	<meta charset="UTF-8">
	<title>Blockly Original</title>
	<script src="https://blockly-demo.appspot.com/static/blockly_compressed.js"></script>
	<script src="https://blockly-demo.appspot.com/static/blocks_compressed.js"></script>
	<script src="https://blockly-demo.appspot.com/static/javascript_compressed.js"></script>
	<script src="https://blockly-demo.appspot.com/static/msg/js/en.js"></script>
	<script src="blocks_original.js"></script>
	<script src="generator_original.js"></script>
	<script src="https://ace.c9.io/build/src/ace.js"></script>
	<style>
		div#bloc{
			position:absolute;
			top:0%;
			left:0%;
			height: 100%;
			width:60%;
		}
		div#code{
			position:absolute;
			top:0%;
			left:60%;
			height: 100%;
			width:40%;
		}		
	</style>
</head>
<body>
	<xml id="toolbox" style="display: none">
		<category name="Logic">
			<block type="controls_if"></block>
			<block type="logic_boolean"></block>
			<block type="logic_compare"></block>
			<block type="logic_operation"></block>
			<block type="logic_negate"></block>
			<block type="logic_null"></block>
			<block type="logic_ternary"></block>
		</category>
		<category name="Loops">
			<block type="controls_repeat_ext"></block>
			<block type="controls_whileUntil"></block>
			<block type="controls_for"></block>
			<block type="controls_forEach"></block>
			<block type="controls_flow_statements"></block>
		</category>
		<category name="Math">
			<block type="math_number"></block>
			<block type="math_arithmetic"></block>
			<block type="math_single"></block>
			<block type="math_trig"></block>
			<block type="math_constant"></block>
			<block type="math_number_property"></block>
			<block type="math_change"></block>
			<block type="math_round"></block>
			<block type="math_on_list"></block>
			<block type="math_modulo"></block>
			<block type="math_constrain"></block>
			<block type="math_random_int"></block>
			<block type="math_random_float"></block>
		</category>	
		<category name="Text">
			<block type="text"></block>
			<block type="text_join"></block>
			<block type="text_append"></block>
			<block type="text_length"></block>
			<block type="text_isEmpty"></block>
			<block type="text_indexOf"></block>
			<block type="text_charAt"></block>
			<block type="text_getSubstring"></block>
			<block type="text_changeCase"></block>
			<block type="text_trim"></block>
			<block type="text_print"></block>
			<block type="text_prompt_ext"></block>
			<block type="text_prompt"></block>
			<block type="text_count"></block>
			<block type="text_replace"></block>
			<block type="text_reverse"></block>
		</category>	
		<category name="Lists">
			<block type="lists_create_empty"></block>
			<block type="lists_repeat"></block>
			<block type="lists_reverse"></block>
			<block type="lists_isEmpty"></block>
			<block type="lists_length"></block>
			<block type="lists_create_with"></block>
			<block type="lists_indexOf"></block>
			<block type="lists_getIndex"></block>
			<block type="lists_setIndex"></block>
			<block type="lists_getSublist"></block>
			<block type="lists_sort"></block>
			<block type="lists_split"></block>
		</category>
		<category name="colour">
			<block type="colour_picker"></block>
			<block type="colour_random"></block>
			<block type="colour_rgb"></block>
			<block type="colour_blend"></block>
		</category>
		<category name="Variables" custom="VARIABLE"></category>
    	<category name="Functions" custom="PROCEDURE"></category>
    	<category name="Javascript" colour="210">
    		<block type="consloe.log"></block>
    	</category>
	</xml>
<!-- ======================================== -->
	<div id='bloc'></div>
	<div id='code'></div>

<script>
	var workspace = Blockly.inject('bloc',
	{	
		toolbox: document.getElementById('toolbox'),
		zoom:{controls: true,startScale: 0.8},
	});

	var editor = ace.edit("code");
	editor.setTheme("ace/theme/twilight");
	editor.getSession().setMode("ace/mode/javascript");	
	editor.setReadOnly(true)
	editor.$blockScrolling = Infinity;	
	document.getElementById('code').style.fontSize='14px';

	var jsCode='';
	workspace.addChangeListener(function(event){
		jsCode = Blockly.JavaScript.workspaceToCode(workspace)
		editor.setValue(jsCode);
		// console.log(event.type)
	})

	document.addEventListener("keypress", function(event){
		if(event.key=='Enter'){
			console.clear()
			eval(jsCode)
		}
	})
</script>	
</body>	
</html>